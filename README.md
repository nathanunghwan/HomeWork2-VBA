# **The VBA of Wallstreet**
- It is to analyze how much stock prices have changed over the year


# **Overview of Project**
### Purpose
- The purpose of this project is to use Microsoft Excel VBA code to summarize information about changes in stock price in the year 2018, 2019 and 2020.

### The table of results presented
- Two result tables are presented. 
- The first is data information calculated for each stock. The information contains the ticker, the value of yearly change, the value of the percent change and the value of the total stock volume. 
- The second one is the data about the highest value among all stock.
It includes the ticker of the greatest % increase, 
the greatest % decrease and the greatest total volume.



# **Getting Started**
### Prerequisites
- Excel


### Usage
- Open the excel file and Click the "Analysis Stock price" button (you can get the excel file from the link below). Data analysis results for 2018, 2019, and 2020 are automatically calculated.
- Click here to view the Excel file: https://gskku-my.sharepoint.com/:x:/g/personal/sarihwa_g_skku_edu/EfRI-iGN25tOvZBbuODoenwBdLwSm-CesenTv1HlT9UMXA?e=2haS5x

# **Description**
- Working on multiple sheets with one macro

```
Sub Stock_Analysis()
    Count_sheet = ActiveWorkbook.Worksheets.Count
     For j = 1 To Count_sheet

     Worksheets(j).Activate  

     <Enter code to run>



     Next j
 
 'Activate the first worksheet after completing
 Worksheets(1).Activate
 Range("A1").Select

End Sub 
 ```
     
- Function for VBA
````
Max = WorksheetFunction.Max(Range("K2:" & "K" & lastRow))
Min = WorksheetFunction.Min(Range("K2:" & "K" & lastRow))
Index, Match =
WorksheetFunction.Index(Range("I2:" & "I" & lastRow), WorksheetFunction.Match(Range("R2").Value, Range("K2:" & "K" & lastRow), 0))
````

- Interior Format
```
If Cells(ticker_num, 10).Value > 0 Then
     Cells(ticker_num, 10).Interior.ColorIndex = "4"
                 
ElseIf Cells(ticker_num, 10).Value < 0 Then
    Cells(ticker_num, 10).Interior.ColorIndex = "3"
                
Else      'open price = close price                                                        
    Cells(ticker_num, 10).Interior.ColorIndex = "0"
                
End If
````
- Number Format
````
Cells(ticker_num, 10).NumberFormat = "[$$]#,##0.00 "
Cells(ticker_num, 11).NumberFormat = "0.00%;[red]-0.00%"
Cells(ticker_num, 12).NumberFormat = "#,##0"             Cells(ticker_num, 10).NumberFormat = "[$$]#,##0.00 "
Cells(ticker_num, 11).NumberFormat = "0.00%;[red]-0.00%"
Cells(ticker_num, 12).NumberFormat = "#,##0"
````
- Set colum Wideth
````
Columns("I:R").EntireColumn.AutoFit
Range("I:I,Q:Q").Select
Selection.ColumnWidth = 11
````

# **Require Subsequent Update**
### The follow-up analysis is required. 
- The first is whether stock prices have changed rapidly at a specific time. 
- The second is how long the period of rapid change has been.  
- Through this analysis, we are able to verify whether the method of momentum investing is right.

 - So I would like to update that code later.




# **References Link for VBA Function**
1. Max :  
 https://learn.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.max

 2. Min:  
 https://learn.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.min

 3. Index:  
 https://learn.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.index

 4. Match:  
https://learn.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match


# **Resources**
- Dataset generated by Trilogy Education Services, LLC.

